<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Payment - FoodieHub</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <style>
      body {
        background: linear-gradient(135deg, #fff5f7, #ffe8e8, #fff5f0);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }
      footer {
        background: linear-gradient(90deg, #dd2476, #ff512f);
        margin-top: auto;
      }
      .payment-container {
        max-width: 700px;
        margin: 40px auto;
        padding: 2rem;
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      }
      .btn-pay {
        background: linear-gradient(90deg, #ff512f, #dd2476);
        border: none;
        border-radius: 8px;
      }
      .order-summary {
        border: 1px solid #ddd;
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 20px;
        background: #fffaf7;
      }
    </style>
  </head>
  <body>
    <!-- Common Navbar -->
    <div id="navbar"></div>

    <!-- Payment Section -->
    <div class="payment-container">
      <h2 class="text-center mb-4">ðŸ’³ Payment</h2>

      <!-- Order Summary -->
      <div class="order-summary">
        <h5 class="mb-3">ðŸ›’ Order Summary</h5>
        <ul id="orderItems" class="list-group mb-3"></ul>
        <h5 class="text-end">Total: â‚¹<span id="totalAmount">0</span></h5>
      </div>

      <!-- Payment Form -->
      <form id="paymentForm">
        <div class="mb-3">
          <label for="cardNumber" class="form-label">Card Number</label>
          <input
            type="text"
            id="cardNumber"
            class="form-control"
            placeholder="1234 5678 9012 3456"
            required
          />
        </div>
        <div class="row">
          <div class="col-md-6 mb-3">
            <label for="expiry" class="form-label">Expiry Date</label>
            <input
              type="text"
              id="expiry"
              class="form-control"
              placeholder="MM/YY"
              required
            />
          </div>
          <div class="col-md-6 mb-3">
            <label for="cvv" class="form-label">CVV</label>
            <input
              type="password"
              id="cvv"
              class="form-control"
              placeholder="123"
              required
            />
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label">Payment Method</label>
          <select class="form-select" id="method">
            <option value="card">Credit/Debit Card</option>
            <option value="upi">UPI</option>
            <option value="cod">Cash on Delivery</option>
          </select>
        </div>
        <button type="submit" class="btn btn-pay w-100 text-white">
          Pay Now
        </button>
      </form>
    </div>

    <!-- Footer -->
    <footer class="text-white text-center py-3">
      <p class="mb-0">&copy; 2025 FoodieHub | All Rights Reserved</p>
    </footer>

    <!-- Scripts -->
    <script>
      // Load Navbar
      fetch("navbar.html")
        .then((res) => res.text())
        .then((data) => {
          document.getElementById("navbar").innerHTML = data;
          updateNavbar();
        });

      function updateNavbar() {
        const isLoggedIn = localStorage.getItem("isLoggedIn") === "true";
        const currentUser = JSON.parse(localStorage.getItem("currentUser"));
        const authLink = document.getElementById("authLink");
        if (isLoggedIn && currentUser) {
          authLink.innerHTML = `<a class="nav-link" href="#" onclick="logout()">Logout (${currentUser.name})</a>`;
        } else {
          authLink.innerHTML = `<a class="nav-link" href="login.html">Login</a>`;
        }
      }
      function logout() {
        localStorage.removeItem("isLoggedIn");
        localStorage.removeItem("currentUser");
        alert("You have logged out!");
        window.location.href = "login.html";
      }

      // Show Cart Items in Order Summary
      const cart = JSON.parse(localStorage.getItem("cart")) || [];
      const orderItems = document.getElementById("orderItems");
      const totalAmount = document.getElementById("totalAmount");

      let total = 0;
      if (cart.length === 0) {
        orderItems.innerHTML = `<li class="list-group-item text-center text-muted">No items in cart</li>`;
      } else {
        cart.forEach((item, index) => {
          const price = Number(item.price);
          const quantity = Number(item.qty);
console.log(item);
console.log(quantity);
          const li = document.createElement("li");
          li.className =
            "list-group-item d-flex justify-content-between align-items-center";
          li.innerHTML = `
    <span>${item.name} (x${quantity})</span>
    <span>â‚¹${price * quantity}</span>
  `;
          orderItems.appendChild(li);
          total += price * quantity;
        });
      }
      totalAmount.textContent = total;

      // Handle Payment
      document
        .getElementById("paymentForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();
          if (cart.length === 0) {
            alert("Your cart is empty!");
            return;
          }
          alert("âœ… Payment Successful! Your order is placed.");
          localStorage.removeItem("cart"); // clear cart
          window.location.href = "index.html";
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
